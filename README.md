# Репозиторий внутреннего сервиса проекта 294

## Оглавление
- [Описание сервиса](#описание-сервиса)
- [Особенности подключения к БД](#особенности-подключения-к-бд)
- [Особенности работы со статикой и медиа файлами](#особенности-работы-со-статикой-и-медиа-файлами)
- [Особенности CI/CD конфигурации](#особенности-cicd-конфигурации)

## Описание сервиса
Данный сервис представляет собой панель управеления проектом. 
В версии 1.0 предполагается наличие следующих параметров/функций:
- Разграничение на роли внутри проекта по [принципу минимальных привилегий](https://ru.wikipedia.org/wiki/%D0%9F%D1%80%D0%B8%D0%BD%D1%86%D0%B8%D0%BF_%D0%BC%D0%B8%D0%BD%D0%B8%D0%BC%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D1%85_%D0%BF%D1%80%D0%B8%D0%B2%D0%B8%D0%BB%D0%B5%D0%B3%D0%B8%D0%B9).
- Удобный интерфейс для получения статистике об использовании проекта: количество пользователей, помещений и т.д.
- Удобный интерфейс для добавления замков со стороны производителей.
- Наличие двухфакторной аутентификации с помощью Google Authenticator.
- Просмотр, отправка и получение почты через внутренний mail-сервер.

## Особенности подключения к БД

В рамках данного проекта планируется переход к микросервисной архитектуре, поэтому подключение к кластеру имеет следующие особенности для данного сервиса:

- При работе на локальном устройстве (при разработке) необходимо установление SSH-туннеля к серверу с БД. Для этого необходимо уточнить SSH порт у системного администратора. Локальный порт, как правило, устанавливается на `5432`. *Обратите внимание, если на локальном устройстве есть экземпляр PostgreSQL, то стоит выбрать другой порт.*
После установления SSH-туннеля, введите логин и пароль от учётной записи PostgreSQL в `.env` файл, который должен находиться в папке с `settings.py`. База данных должна быть доступна по адресу `localhost:port`. __Используйте удалённый доступ к БД только при необходимости.__
---
##### *ВАЖНО: группа пользователей, выделенная данному сервису на кластере БД, НЕ МОЖЕТ ВЫПОЛНЯТЬ МИГРАЦИИ - __ТОЛЬКО__ ОПЕРАЦИИ ЧТЕНИЯ И ЗАПИСИ. Используйте локальные БД для тестирования, т.к. там необходимы права на миграцию.*
---
- В production среде данный сервис подключается к БД через VPC, в которой находится сервер с сервисом.

## Особенности работы со статикой и медиа файлами
Из-за необходимости использования нескольких отдельных серверов для улучшения производительности, в production-среде все static и media файлы находятся в облаке, предоставленном __DigitalOcean__.

## Особенности CI/CD конфигурации
CI/CD конфигурация представляет собой обособленный контейнер, который при коммитах в master ветку автоматически проходит тестирование текущей версии. По умолчанию, deploy стадия всегда находится в ручном режиме. 

